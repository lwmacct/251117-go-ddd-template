basePath: /api
definitions:
  auditlog.AuditLogDTO:
    properties:
      action:
        type: string
      created_at:
        type: string
      details:
        type: string
      id:
        type: integer
      ip_address:
        type: string
      resource:
        type: string
      status:
        type: string
      user_agent:
        type: string
      user_id:
        type: integer
    type: object
  auth.Login2FADTO:
    properties:
      session_token:
        description: 登录时返回的临时会话令牌
        example: eyJhbGciOiJIUzI1NiIs...
        type: string
      two_factor_code:
        description: 6位TOTP验证码
        example: "123456"
        type: string
    required:
    - session_token
    - two_factor_code
    type: object
  auth.LoginDTO:
    properties:
      account:
        description: 手机号/用户名/邮箱
        example: admin
        type: string
      captcha:
        description: 验证码
        example: "9999"
        type: string
      captcha_id:
        description: 验证码ID
        example: dev-123456
        type: string
      password:
        description: 密码
        example: admin123
        type: string
    required:
    - account
    - captcha
    - captcha_id
    - password
    type: object
  auth.LoginResponseDTO:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      token_type:
        type: string
      user:
        $ref: '#/definitions/auth.UserBriefDTO'
    type: object
  auth.RefreshTokenDTO:
    properties:
      refresh_token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
    required:
    - refresh_token
    type: object
  auth.RegisterDTO:
    properties:
      email:
        example: john@example.com
        type: string
      full_name:
        example: John Doe
        maxLength: 100
        type: string
      password:
        example: password123
        minLength: 6
        type: string
      username:
        example: john_doe
        maxLength: 50
        minLength: 3
        type: string
    required:
    - email
    - password
    - username
    type: object
  auth.RegisterResultDTO:
    properties:
      access_token:
        type: string
      email:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      token_type:
        type: string
      user_id:
        type: integer
      username:
        type: string
    type: object
  auth.TokenDTO:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      token_type:
        type: string
    type: object
  auth.UserBriefDTO:
    properties:
      user_id:
        type: integer
      username:
        type: string
    type: object
  cache.DeleteCacheResultDTO:
    properties:
      key:
        type: string
    type: object
  cache.GetCacheResultDTO:
    properties:
      key:
        type: string
      value: {}
    type: object
  cache.SetCacheDTO:
    properties:
      key:
        type: string
      ttl:
        description: 秒，默认 60
        type: integer
      value: {}
    required:
    - key
    - value
    type: object
  cache.SetCacheResultDTO:
    properties:
      key:
        type: string
      ttl:
        type: integer
    type: object
  captcha.GenerateCaptchaResultDTO:
    properties:
      code:
        description: Code 验证码值（仅开发模式返回）
        type: string
      expire_at:
        description: ExpireAt 过期时间戳（秒）
        type: integer
      id:
        description: ID 验证码ID
        type: string
      image:
        description: Image Base64编码的图片
        type: string
    type: object
  handler.BatchUpdateSettingsRequest:
    properties:
      settings:
        items:
          properties:
            key:
              type: string
            value:
              type: string
          required:
          - key
          - value
          type: object
        type: array
    required:
    - settings
    type: object
  handler.CreateMenuRequest:
    properties:
      icon:
        example: setting
        maxLength: 100
        type: string
      order:
        example: 1
        type: integer
      parent_id:
        example: 0
        type: integer
      path:
        example: /system
        maxLength: 255
        type: string
      title:
        example: 系统管理
        maxLength: 100
        minLength: 1
        type: string
      visible:
        example: true
        type: boolean
    required:
    - path
    - title
    type: object
  handler.CreateSettingRequest:
    properties:
      category:
        example: general
        type: string
      key:
        example: site_name
        type: string
      label:
        example: 网站名称
        type: string
      value:
        example: My Website
        type: string
      value_type:
        example: string
        type: string
    required:
    - category
    - key
    - value
    type: object
  handler.ReorderMenusRequest:
    properties:
      menus:
        items:
          properties:
            id:
              type: integer
            order:
              type: integer
            parent_id:
              type: integer
          required:
          - id
          type: object
        type: array
    required:
    - menus
    type: object
  handler.UpdateMenuRequest:
    properties:
      icon:
        maxLength: 100
        type: string
      order:
        type: integer
      parent_id:
        type: integer
      path:
        maxLength: 255
        type: string
      title:
        maxLength: 100
        minLength: 1
        type: string
      visible:
        type: boolean
    type: object
  handler.UpdateProfileRequest:
    properties:
      avatar:
        example: https://example.com/avatar.jpg
        maxLength: 255
        type: string
      bio:
        example: 这是我的个人简介
        type: string
      full_name:
        example: 张三
        maxLength: 100
        type: string
    type: object
  handler.UpdateSettingRequest:
    properties:
      label:
        example: 更新后的标签
        type: string
      value:
        example: Updated Value
        type: string
      value_type:
        example: string
        type: string
    required:
    - value
    type: object
  menu.MenuDTO:
    properties:
      created_at:
        type: string
      icon:
        type: string
      id:
        type: integer
      order:
        type: integer
      parent_id:
        type: integer
      path:
        type: string
      title:
        type: string
      updated_at:
        type: string
      visible:
        type: boolean
    type: object
  pat.CreateTokenDTO:
    properties:
      description:
        description: 可选，备注
        type: string
      expires_at:
        description: 可选，过期时间（RFC3339 或 yyyy-MM-ddTHH:mm）
        type: string
      expires_in:
        description: 可选，以天为单位的有效期（兜底，前端未使用时可忽略）
        type: integer
      ip_whitelist:
        description: 可选，IP 白名单
        items:
          type: string
        type: array
      name:
        maxLength: 100
        minLength: 3
        type: string
      permissions:
        description: 可选，限制令牌权限范围（为空则默认用户全部权限）
        items:
          type: string
        type: array
    required:
    - name
    type: object
  pat.CreateTokenResultDTO:
    properties:
      plain_token:
        type: string
      token:
        $ref: '#/definitions/pat.TokenDTO'
    type: object
  pat.TokenDTO:
    properties:
      created_at:
        type: string
      expires_at:
        type: string
      id:
        type: integer
      ip_whitelist:
        items:
          type: string
        type: array
      last_used_at:
        type: string
      name:
        type: string
      permissions:
        items:
          type: string
        type: array
      status:
        type: string
      token_prefix:
        type: string
      updated_at:
        type: string
      user_id:
        type: integer
    type: object
  response.DataResponse-array_menu_MenuDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: '#/definitions/menu.MenuDTO'
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-array_pat_TokenDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: '#/definitions/pat.TokenDTO'
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-array_setting_SettingDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 响应数据
        items:
          $ref: '#/definitions/setting.SettingDTO'
        type: array
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-auditlog_AuditLogDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/auditlog.AuditLogDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-auth_LoginResponseDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/auth.LoginResponseDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-auth_RegisterResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/auth.RegisterResultDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-auth_TokenDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/auth.TokenDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-cache_DeleteCacheResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/cache.DeleteCacheResultDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-cache_GetCacheResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/cache.GetCacheResultDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-cache_SetCacheResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/cache.SetCacheResultDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-captcha_GenerateCaptchaResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/captcha.GenerateCaptchaResultDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-menu_MenuDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/menu.MenuDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-pat_CreateTokenResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/pat.CreateTokenResultDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-pat_TokenDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/pat.TokenDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-role_CreateRoleResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/role.CreateRoleResultDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-role_RoleDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/role.RoleDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-setting_SettingDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/setting.SettingDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-stats_StatsDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/stats.StatsDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-twofa_EnableDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/twofa.EnableDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-twofa_SetupDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/twofa.SetupDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-twofa_StatusDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/twofa.StatusDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-user_BatchCreateUserResultDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/user.BatchCreateUserResultDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.DataResponse-user_UserWithRolesDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        allOf:
        - $ref: '#/definitions/user.UserWithRolesDTO'
        description: 响应数据
      error:
        description: 错误详情（仅失败时）
      message:
        description: 消息描述
        type: string
    type: object
  response.ErrorDetail:
    properties:
      code:
        description: 业务错误码（小写下划线）
        type: string
      details:
        description: 额外详情（如验证错误列表）
      message:
        description: 错误消息
        type: string
    type: object
  response.ErrorResponse:
    properties:
      error:
        $ref: '#/definitions/response.ErrorDetail'
    type: object
  response.MessageResponse:
    description: 纯消息响应格式
    properties:
      code:
        description: HTTP 状态码
        type: integer
      message:
        description: 消息描述
        type: string
    type: object
  response.PagedResponse-auditlog_AuditLogDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: '#/definitions/auditlog.AuditLogDTO'
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
        - $ref: '#/definitions/response.PaginationMeta'
        description: 分页信息
    type: object
  response.PagedResponse-role_PermissionDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: '#/definitions/role.PermissionDTO'
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
        - $ref: '#/definitions/response.PaginationMeta'
        description: 分页信息
    type: object
  response.PagedResponse-role_RoleDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: '#/definitions/role.RoleDTO'
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
        - $ref: '#/definitions/response.PaginationMeta'
        description: 分页信息
    type: object
  response.PagedResponse-user_UserWithRolesDTO:
    properties:
      code:
        description: HTTP 状态码
        type: integer
      data:
        description: 数据列表
        items:
          $ref: '#/definitions/user.UserWithRolesDTO'
        type: array
      message:
        description: 消息描述
        type: string
      meta:
        allOf:
        - $ref: '#/definitions/response.PaginationMeta'
        description: 分页信息
    type: object
  response.PaginationMeta:
    properties:
      has_more:
        description: 是否有下一页
        type: boolean
      page:
        description: 当前页码
        type: integer
      per_page:
        description: 每页数量
        type: integer
      total:
        description: 总记录数
        type: integer
      total_pages:
        description: 总页数
        type: integer
    type: object
  response.Response:
    properties:
      data:
        description: 数据
      message:
        description: 消息
        type: string
    type: object
  role.CreateRoleDTO:
    properties:
      description:
        example: 系统开发人员角色
        maxLength: 255
        type: string
      display_name:
        example: 开发者
        maxLength: 100
        type: string
      name:
        example: developer
        maxLength: 50
        minLength: 2
        type: string
    required:
    - display_name
    - name
    type: object
  role.CreateRoleResultDTO:
    properties:
      display_name:
        type: string
      name:
        type: string
      role_id:
        type: integer
    type: object
  role.PermissionDTO:
    properties:
      action:
        type: string
      code:
        type: string
      created_at:
        type: string
      description:
        type: string
      id:
        type: integer
      name:
        type: string
      resource:
        type: string
      updated_at:
        type: string
    type: object
  role.RoleDTO:
    properties:
      created_at:
        type: string
      description:
        type: string
      display_name:
        type: string
      id:
        type: integer
      is_system:
        type: boolean
      name:
        type: string
      permissions:
        items:
          $ref: '#/definitions/role.PermissionDTO'
        type: array
      updated_at:
        type: string
    type: object
  role.SetPermissionsDTO:
    properties:
      permission_ids:
        items:
          type: integer
        type: array
    required:
    - permission_ids
    type: object
  role.UpdateRoleDTO:
    properties:
      description:
        maxLength: 255
        type: string
      display_name:
        maxLength: 100
        type: string
    type: object
  setting.SettingDTO:
    properties:
      category:
        type: string
      created_at:
        type: string
      id:
        type: integer
      key:
        type: string
      label:
        type: string
      updated_at:
        type: string
      value:
        type: string
      value_type:
        type: string
    type: object
  stats.AuditLogSummaryDTO:
    properties:
      action:
        type: string
      created_at:
        type: string
      id:
        type: integer
      resource:
        type: string
      status:
        type: string
      user_id:
        type: integer
      username:
        type: string
    type: object
  stats.StatsDTO:
    properties:
      active_users:
        type: integer
      banned_users:
        type: integer
      inactive_users:
        type: integer
      recent_audit_logs:
        items:
          $ref: '#/definitions/stats.AuditLogSummaryDTO'
        type: array
      total_menus:
        type: integer
      total_permissions:
        type: integer
      total_roles:
        type: integer
      total_users:
        type: integer
    type: object
  twofa.EnableDTO:
    properties:
      message:
        description: 提示消息
        type: string
      recovery_codes:
        description: 恢复码列表
        items:
          type: string
        type: array
    type: object
  twofa.SetupDTO:
    properties:
      qrcode_img:
        description: Base64 编码的二维码图片
        type: string
      qrcode_url:
        description: 二维码 URL
        type: string
      secret:
        description: TOTP 密钥（用户可手动输入）
        type: string
    type: object
  twofa.StatusDTO:
    properties:
      enabled:
        description: 是否启用
        type: boolean
      recovery_codes_count:
        description: 剩余恢复码数量
        type: integer
    type: object
  twofa.VerifyDTO:
    properties:
      code:
        description: TOTP 验证码
        example: "123456"
        type: string
    required:
    - code
    type: object
  user.AssignRolesDTO:
    properties:
      role_ids:
        items:
          type: integer
        type: array
    required:
    - role_ids
    type: object
  user.BatchCreateErrorDTO:
    properties:
      email:
        type: string
      error:
        type: string
      index:
        type: integer
      username:
        type: string
    type: object
  user.BatchCreateUserDTO:
    properties:
      users:
        items:
          $ref: '#/definitions/user.BatchUserItemDTO'
        maxItems: 100
        minItems: 1
        type: array
    required:
    - users
    type: object
  user.BatchCreateUserResultDTO:
    properties:
      errors:
        items:
          $ref: '#/definitions/user.BatchCreateErrorDTO'
        type: array
      failed:
        type: integer
      success:
        type: integer
      total:
        type: integer
    type: object
  user.BatchUserItemDTO:
    properties:
      email:
        type: string
      full_name:
        maxLength: 100
        type: string
      password:
        minLength: 6
        type: string
      role_ids:
        items:
          type: integer
        type: array
      status:
        enum:
        - active
        - inactive
        type: string
      username:
        maxLength: 50
        minLength: 3
        type: string
    required:
    - email
    - password
    - username
    type: object
  user.ChangePasswordDTO:
    properties:
      new_password:
        minLength: 6
        type: string
      old_password:
        type: string
    required:
    - new_password
    - old_password
    type: object
  user.CreateUserDTO:
    properties:
      email:
        type: string
      full_name:
        maxLength: 100
        type: string
      password:
        minLength: 6
        type: string
      role_ids:
        items:
          type: integer
        type: array
      status:
        enum:
        - active
        - inactive
        type: string
      username:
        maxLength: 50
        minLength: 3
        type: string
    required:
    - email
    - password
    - username
    type: object
  user.RoleDTO:
    properties:
      description:
        type: string
      display_name:
        type: string
      id:
        type: integer
      name:
        type: string
    type: object
  user.UpdateUserDTO:
    properties:
      avatar:
        maxLength: 255
        type: string
      bio:
        type: string
      email:
        type: string
      full_name:
        maxLength: 100
        type: string
      status:
        enum:
        - active
        - inactive
        - banned
        type: string
      username:
        maxLength: 50
        minLength: 3
        type: string
    type: object
  user.UserWithRolesDTO:
    properties:
      avatar:
        type: string
      bio:
        type: string
      created_at:
        type: string
      email:
        type: string
      full_name:
        type: string
      id:
        type: integer
      roles:
        items:
          $ref: '#/definitions/user.RoleDTO'
        type: array
      status:
        type: string
      updated_at:
        type: string
      username:
        type: string
    type: object
host: localhost:40012
info:
  contact:
    email: lwmacct@icloud.com
    name: API Support
    url: https://github.com/lwmacct/251117-go-ddd-template/issues
  description: 基于 DDD+CQRS 架构的 Go Web 应用 API 文档
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://github.com/lwmacct/251117-go-ddd-template
  title: Go DDD Template API
  version: 1.0.3
paths:
  /api/admin/auditlogs:
    get:
      consumes:
      - application/json
      description: 分页获取审计日志，支持按用户、操作、资源、状态、时间范围筛选
      parameters:
      - default: 1
        description: 页码
        in: query
        minimum: 1
        name: page
        type: integer
      - default: 20
        description: 每页数量
        in: query
        maximum: 100
        minimum: 1
        name: limit
        type: integer
      - description: 用户ID
        in: query
        name: user_id
        type: integer
      - description: 操作类型
        enum:
        - create
        - update
        - delete
        - login
        - logout
        in: query
        name: action
        type: string
      - description: 资源类型
        enum:
        - user
        - role
        - menu
        - setting
        in: query
        name: resource
        type: string
      - description: 状态
        enum:
        - success
        - failure
        in: query
        name: status
        type: string
      - description: 开始时间(RFC3339格式)
        in: query
        name: start_date
        type: string
      - description: 结束时间(RFC3339格式)
        in: query
        name: end_date
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 审计日志列表
          schema:
            $ref: '#/definitions/response.PagedResponse-auditlog_AuditLogDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取审计日志列表
      tags:
      - 管理员 - 审计日志 (Admin - Audit Log)
      x-permission:
        scope: admin:auditlogs:read
  /api/admin/auditlogs/{id}:
    get:
      consumes:
      - application/json
      description: 根据日志ID获取审计日志详细信息
      parameters:
      - description: 日志ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 日志详情
          schema:
            $ref: '#/definitions/response.DataResponse-auditlog_AuditLogDTO'
        "400":
          description: 无效的日志ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 日志不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取审计日志详情
      tags:
      - 管理员 - 审计日志 (Admin - Audit Log)
      x-permission:
        scope: admin:auditlogs:read
  /api/admin/menus:
    get:
      consumes:
      - application/json
      description: 获取所有菜单的树形结构（包含父子关系）
      produces:
      - application/json
      responses:
        "200":
          description: 菜单树
          schema:
            $ref: '#/definitions/response.DataResponse-array_menu_MenuDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取菜单列表
      tags:
      - 管理员 - 菜单管理 (Admin - Menu Management)
      x-permission:
        scope: admin:menus:read
    post:
      consumes:
      - application/json
      description: 管理员创建新的系统菜单项
      parameters:
      - description: 菜单信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.CreateMenuRequest'
      produces:
      - application/json
      responses:
        "201":
          description: 菜单创建成功
          schema:
            $ref: '#/definitions/response.DataResponse-menu_MenuDTO'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建菜单
      tags:
      - 管理员 - 菜单管理 (Admin - Menu Management)
      x-permission:
        scope: admin:menus:create
  /api/admin/menus/{id}:
    delete:
      consumes:
      - application/json
      description: 管理员删除指定菜单（如果有子菜单，可能会失败）
      parameters:
      - description: 菜单ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "204":
          description: 菜单删除成功
        "400":
          description: 无效的菜单ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 菜单不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误或菜单有子项
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除菜单
      tags:
      - 管理员 - 菜单管理 (Admin - Menu Management)
      x-permission:
        scope: admin:menus:delete
    get:
      consumes:
      - application/json
      description: 根据菜单ID获取菜单详细信息
      parameters:
      - description: 菜单ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 菜单详情
          schema:
            $ref: '#/definitions/response.DataResponse-menu_MenuDTO'
        "400":
          description: 无效的菜单ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 菜单不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取菜单详情
      tags:
      - 管理员 - 菜单管理 (Admin - Menu Management)
      x-permission:
        scope: admin:menus:read
    put:
      consumes:
      - application/json
      description: 管理员更新菜单的标题、路径、图标等信息
      parameters:
      - description: 菜单ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      - description: 更新信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.UpdateMenuRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 菜单更新成功
          schema:
            $ref: '#/definitions/response.DataResponse-menu_MenuDTO'
        "400":
          description: 无效的菜单ID或参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 菜单不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新菜单信息
      tags:
      - 管理员 - 菜单管理 (Admin - Menu Management)
      x-permission:
        scope: admin:menus:update
  /api/admin/menus/reorder:
    post:
      consumes:
      - application/json
      description: 管理员批量更新菜单的排序和父级关系
      parameters:
      - description: 菜单排序信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.ReorderMenusRequest'
      produces:
      - application/json
      responses:
        "204":
          description: 菜单排序更新成功
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 批量更新菜单排序
      tags:
      - 管理员 - 菜单管理 (Admin - Menu Management)
      x-permission:
        scope: admin:menus:update
  /api/admin/overview/stats:
    get:
      consumes:
      - application/json
      description: 获取用户、角色、权限、菜单等统计信息
      produces:
      - application/json
      responses:
        "200":
          description: 统计信息
          schema:
            $ref: '#/definitions/response.DataResponse-stats_StatsDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取系统概览统计
      tags:
      - 系统概览 (Overview)
  /api/admin/permissions:
    get:
      consumes:
      - application/json
      description: 分页获取所有系统权限
      parameters:
      - default: 1
        description: 页码
        in: query
        minimum: 1
        name: page
        type: integer
      - default: 50
        description: 每页数量
        in: query
        maximum: 100
        minimum: 1
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 权限列表
          schema:
            $ref: '#/definitions/response.PagedResponse-role_PermissionDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取权限列表
      tags:
      - 管理员 - 角色管理 (Admin - Role Management)
      x-permission:
        scope: admin:permissions:read
  /api/admin/roles:
    get:
      consumes:
      - application/json
      description: 分页获取所有系统角色
      parameters:
      - default: 1
        description: 页码
        in: query
        minimum: 1
        name: page
        type: integer
      - default: 20
        description: 每页数量
        in: query
        maximum: 100
        minimum: 1
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 角色列表
          schema:
            $ref: '#/definitions/response.PagedResponse-role_RoleDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取角色列表
      tags:
      - 管理员 - 角色管理 (Admin - Role Management)
      x-permission:
        scope: admin:roles:read
    post:
      consumes:
      - application/json
      description: 管理员创建新的系统角色
      parameters:
      - description: 角色信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/role.CreateRoleDTO'
      produces:
      - application/json
      responses:
        "201":
          description: 角色创建成功
          schema:
            $ref: '#/definitions/response.DataResponse-role_CreateRoleResultDTO'
        "400":
          description: 参数错误或角色名已存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建角色
      tags:
      - 管理员 - 角色管理 (Admin - Role Management)
      x-permission:
        scope: admin:roles:create
  /api/admin/roles/{id}:
    delete:
      consumes:
      - application/json
      description: 管理员删除指定角色（如果角色被用户使用，可能会失败）
      parameters:
      - description: 角色ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 角色删除成功
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "400":
          description: 无效的角色ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 角色不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误或角色被使用中
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除角色
      tags:
      - 管理员 - 角色管理 (Admin - Role Management)
      x-permission:
        scope: admin:roles:delete
    get:
      consumes:
      - application/json
      description: 根据角色ID获取角色详细信息（包含权限列表）
      parameters:
      - description: 角色ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 角色详情
          schema:
            $ref: '#/definitions/response.DataResponse-role_RoleDTO'
        "400":
          description: 无效的角色ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 角色不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取角色详情
      tags:
      - 管理员 - 角色管理 (Admin - Role Management)
      x-permission:
        scope: admin:roles:read
    put:
      consumes:
      - application/json
      description: 管理员更新角色的显示名称和描述
      parameters:
      - description: 角色ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      - description: 更新信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/role.UpdateRoleDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 角色更新成功
          schema:
            $ref: '#/definitions/response.DataResponse-role_RoleDTO'
        "400":
          description: 无效的角色ID或参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 角色不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新角色信息
      tags:
      - 管理员 - 角色管理 (Admin - Role Management)
      x-permission:
        scope: admin:roles:update
  /api/admin/roles/{id}/permissions:
    put:
      consumes:
      - application/json
      description: 管理员为指定角色设置权限（会覆盖现有权限）
      parameters:
      - description: 角色ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      - description: 权限ID列表
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/role.SetPermissionsDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 权限设置成功
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "400":
          description: 无效的角色ID或参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 角色不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 设置角色权限
      tags:
      - 管理员 - 角色管理 (Admin - Role Management)
      x-permission:
        scope: admin:roles:update
  /api/admin/settings:
    get:
      consumes:
      - application/json
      description: 获取所有系统配置，可按类别筛选
      parameters:
      - description: 配置类别
        in: query
        name: category
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 配置列表
          schema:
            $ref: '#/definitions/response.DataResponse-array_setting_SettingDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取系统配置列表
      tags:
      - 管理员 - 系统配置 (Admin - Settings)
      x-permission:
        scope: admin:settings:read
    post:
      consumes:
      - application/json
      description: 管理员创建新的系统配置项
      parameters:
      - description: 配置信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.CreateSettingRequest'
      produces:
      - application/json
      responses:
        "201":
          description: 配置创建成功
          schema:
            $ref: '#/definitions/response.DataResponse-setting_SettingDTO'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建配置
      tags:
      - 管理员 - 系统配置 (Admin - Settings)
      x-permission:
        scope: admin:settings:create
  /api/admin/settings/{key}:
    delete:
      consumes:
      - application/json
      description: 管理员删除指定的系统配置项
      parameters:
      - description: 配置键
        in: path
        name: key
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: 配置删除成功
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 配置不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除配置
      tags:
      - 管理员 - 系统配置 (Admin - Settings)
      x-permission:
        scope: admin:settings:delete
    get:
      consumes:
      - application/json
      description: 根据配置键获取配置详情
      parameters:
      - description: 配置键
        in: path
        name: key
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 配置详情
          schema:
            $ref: '#/definitions/response.DataResponse-setting_SettingDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 配置不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取单个配置
      tags:
      - 管理员 - 系统配置 (Admin - Settings)
      x-permission:
        scope: admin:settings:read
    put:
      consumes:
      - application/json
      description: 管理员更新指定配置项的值和标签
      parameters:
      - description: 配置键
        in: path
        name: key
        required: true
        type: string
      - description: 更新信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.UpdateSettingRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 配置更新成功
          schema:
            $ref: '#/definitions/response.DataResponse-setting_SettingDTO'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 配置不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新配置
      tags:
      - 管理员 - 系统配置 (Admin - Settings)
      x-permission:
        scope: admin:settings:update
  /api/admin/settings/batch:
    post:
      consumes:
      - application/json
      description: 管理员批量更新多个系统配置项的值
      parameters:
      - description: 配置列表
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.BatchUpdateSettingsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 批量更新成功
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 批量更新配置
      tags:
      - 管理员 - 系统配置 (Admin - Settings)
      x-permission:
        scope: admin:settings:update
  /api/admin/users:
    get:
      consumes:
      - application/json
      description: 分页获取所有用户列表（包含角色信息）
      parameters:
      - default: 1
        description: 页码
        in: query
        minimum: 1
        name: page
        type: integer
      - default: 20
        description: 每页数量
        in: query
        maximum: 100
        minimum: 1
        name: limit
        type: integer
      - description: 搜索关键词（用户名或邮箱）
        in: query
        name: search
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 用户列表
          schema:
            $ref: '#/definitions/response.PagedResponse-user_UserWithRolesDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取用户列表
      tags:
      - 管理员 - 用户管理 (Admin - User Management)
      x-permission:
        scope: admin:users:read
    post:
      consumes:
      - application/json
      description: 管理员创建新用户账号，可同时分配角色
      parameters:
      - description: 用户信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/user.CreateUserDTO'
      produces:
      - application/json
      responses:
        "201":
          description: 用户创建成功
          schema:
            $ref: '#/definitions/response.DataResponse-user_UserWithRolesDTO'
        "400":
          description: 参数错误或用户名/邮箱已存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建用户
      tags:
      - 管理员 - 用户管理 (Admin - User Management)
      x-permission:
        scope: admin:users:create
  /api/admin/users/{id}:
    delete:
      consumes:
      - application/json
      description: 管理员删除指定用户（物理删除或软删除）
      parameters:
      - description: 用户ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 用户删除成功
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "400":
          description: 无效的用户ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 用户不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除用户
      tags:
      - 管理员 - 用户管理 (Admin - User Management)
      x-permission:
        scope: admin:users:delete
    get:
      consumes:
      - application/json
      description: 根据用户ID获取用户详细信息（包含角色信息）
      parameters:
      - description: 用户ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 用户详情
          schema:
            $ref: '#/definitions/response.DataResponse-user_UserWithRolesDTO'
        "400":
          description: 无效的用户ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 用户不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取用户详情
      tags:
      - 管理员 - 用户管理 (Admin - User Management)
      x-permission:
        scope: admin:users:read
    put:
      consumes:
      - application/json
      description: 管理员更新用户的基本信息和状态
      parameters:
      - description: 用户ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      - description: 更新信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/user.UpdateUserDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 用户更新成功
          schema:
            $ref: '#/definitions/response.DataResponse-user_UserWithRolesDTO'
        "400":
          description: 无效的用户ID或参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 用户不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新用户信息
      tags:
      - 管理员 - 用户管理 (Admin - User Management)
      x-permission:
        scope: admin:users:update
  /api/admin/users/{id}/roles:
    put:
      consumes:
      - application/json
      description: 管理员为指定用户分配角色（会覆盖现有角色）
      parameters:
      - description: 用户ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      - description: 角色ID列表
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/user.AssignRolesDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 角色分配成功
          schema:
            $ref: '#/definitions/response.DataResponse-user_UserWithRolesDTO'
        "400":
          description: 无效的用户ID或参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 用户不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 分配用户角色
      tags:
      - 管理员 - 用户管理 (Admin - User Management)
      x-permission:
        scope: admin:users:update
  /api/admin/users/batch:
    post:
      consumes:
      - application/json
      description: 管理员从 CSV 等来源批量创建用户，支持部分失败（单个失败不影响其他用户）
      parameters:
      - description: 用户列表（最多 100 个）
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/user.BatchCreateUserDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 批量创建结果
          schema:
            $ref: '#/definitions/response.DataResponse-user_BatchCreateUserResultDTO'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "403":
          description: 权限不足
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 批量创建用户
      tags:
      - 管理员 - 用户管理 (Admin - User Management)
      x-permission:
        scope: admin:users:create
  /api/auth/2fa/disable:
    post:
      consumes:
      - application/json
      description: 禁用当前用户的两步验证功能
      produces:
      - application/json
      responses:
        "200":
          description: 2FA禁用成功
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "400":
          description: 禁用失败
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 禁用两步验证
      tags:
      - 认证 - 两步验证 (Authentication - 2FA)
      x-permission:
        scope: user:2fa:disable
  /api/auth/2fa/setup:
    post:
      consumes:
      - application/json
      description: 为当前用户生成2FA密钥和二维码，用于配置身份验证器应用
      produces:
      - application/json
      responses:
        "200":
          description: 2FA初始化成功
          schema:
            $ref: '#/definitions/response.DataResponse-twofa_SetupDTO'
        "400":
          description: 设置失败
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 初始化两步验证
      tags:
      - 认证 - 两步验证 (Authentication - 2FA)
      x-permission:
        scope: user:2fa:setup
  /api/auth/2fa/status:
    get:
      consumes:
      - application/json
      description: 获取当前用户的2FA启用状态和剩余恢复代码数量
      produces:
      - application/json
      responses:
        "200":
          description: 2FA状态
          schema:
            $ref: '#/definitions/response.DataResponse-twofa_StatusDTO'
        "400":
          description: 获取失败
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取两步验证状态
      tags:
      - 认证 - 两步验证 (Authentication - 2FA)
      x-permission:
        scope: user:2fa:read
  /api/auth/2fa/verify:
    post:
      consumes:
      - application/json
      description: 验证身份验证器应用生成的TOTP代码，成功后启用2FA并返回恢复代码
      parameters:
      - description: TOTP验证码
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/twofa.VerifyDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 2FA启用成功
          schema:
            $ref: '#/definitions/response.DataResponse-twofa_EnableDTO'
        "400":
          description: 验证码错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 验证并启用两步验证
      tags:
      - 认证 - 两步验证 (Authentication - 2FA)
      x-permission:
        scope: user:2fa:setup
  /api/auth/captcha:
    get:
      consumes:
      - application/json
      description: 生成图形验证码用于登录。支持开发模式（通过code和secret参数指定验证码值）
      parameters:
      - description: 开发模式：指定验证码值
        in: query
        name: code
        type: string
      - description: 开发模式：密钥
        in: query
        name: secret
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 验证码生成成功
          schema:
            $ref: '#/definitions/response.DataResponse-captcha_GenerateCaptchaResultDTO'
        "500":
          description: 生成失败
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: 获取图形验证码
      tags:
      - 认证 (Authentication)
  /api/auth/login:
    post:
      consumes:
      - application/json
      description: 使用手机号/用户名/邮箱和密码登录系统，需要提供图形验证码。如果启用了2FA，返回session_token用于后续2FA验证
      parameters:
      - description: 登录凭证
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/auth.LoginDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 登录成功或需要2FA验证
          schema:
            $ref: '#/definitions/response.DataResponse-auth_LoginResponseDTO'
        "401":
          description: 登录失败：凭证无效、验证码错误或账户被禁用
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: 用户登录
      tags:
      - 认证 (Authentication)
  /api/auth/login/2fa:
    post:
      consumes:
      - application/json
      description: 使用session_token和2FA验证码完成登录（适用于启用了2FA的账户）
      parameters:
      - description: 二次认证凭证
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/auth.Login2FADTO'
      produces:
      - application/json
      responses:
        "200":
          description: 登录成功
          schema:
            $ref: '#/definitions/response.DataResponse-auth_TokenDTO'
        "401":
          description: 验证失败：session_token无效或2FA验证码错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: 二次认证登录
      tags:
      - 认证 (Authentication)
  /api/auth/refresh:
    post:
      consumes:
      - application/json
      description: 使用refresh_token获取新的access_token和refresh_token，延长会话有效期
      parameters:
      - description: 刷新令牌
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/auth.RefreshTokenDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 令牌刷新成功
          schema:
            $ref: '#/definitions/response.DataResponse-auth_TokenDTO'
        "401":
          description: 刷新令牌无效或已过期
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: 刷新访问令牌
      tags:
      - 认证 (Authentication)
  /api/auth/register:
    post:
      consumes:
      - application/json
      description: 创建新用户账号，注册成功后自动登录并返回访问令牌
      parameters:
      - description: 注册信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/auth.RegisterDTO'
      produces:
      - application/json
      responses:
        "201":
          description: 注册成功
          schema:
            $ref: '#/definitions/response.DataResponse-auth_RegisterResultDTO'
        "400":
          description: 参数错误或用户名/邮箱已存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: 用户注册
      tags:
      - 认证 (Authentication)
  /api/cache:
    post:
      consumes:
      - application/json
      description: 设置缓存键值对（演示用，公开接口）
      parameters:
      - description: 缓存数据
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/cache.SetCacheDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 设置成功
          schema:
            $ref: '#/definitions/response.DataResponse-cache_SetCacheResultDTO'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: 设置缓存
      tags:
      - 缓存示例 (Cache Demo)
  /api/cache/{key}:
    delete:
      consumes:
      - application/json
      description: 根据 key 删除缓存（演示用，公开接口）
      parameters:
      - description: 缓存键
        in: path
        name: key
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 删除成功
          schema:
            $ref: '#/definitions/response.DataResponse-cache_DeleteCacheResultDTO'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: 删除缓存
      tags:
      - 缓存示例 (Cache Demo)
    get:
      consumes:
      - application/json
      description: 根据 key 获取缓存值（演示用，公开接口）
      parameters:
      - description: 缓存键
        in: path
        name: key
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: 获取成功
          schema:
            $ref: '#/definitions/response.DataResponse-cache_GetCacheResultDTO'
        "404":
          description: 缓存不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      summary: 获取缓存
      tags:
      - 缓存示例 (Cache Demo)
  /api/health:
    get:
      consumes:
      - application/json
      description: 检查系统服务健康状态（数据库、Redis）
      produces:
      - application/json
      responses:
        "200":
          description: 服务健康
          schema:
            allOf:
            - $ref: '#/definitions/response.Response'
            - properties:
                checks:
                  properties:
                    database:
                      type: object
                    redis:
                      type: object
                  type: object
                status:
                  type: string
              type: object
        "503":
          description: 服务降级
          schema:
            allOf:
            - $ref: '#/definitions/response.Response'
            - properties:
                checks:
                  properties:
                    database:
                      type: object
                    redis:
                      type: object
                  type: object
                status:
                  type: string
              type: object
      summary: 健康检查
      tags:
      - 系统 (System)
  /api/user/account:
    delete:
      consumes:
      - application/json
      description: 用户删除自己的账号（不可恢复）
      produces:
      - application/json
      responses:
        "200":
          description: 账号删除成功
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除账号
      tags:
      - 用户 - 个人资料 (User - Profile)
      x-permission:
        scope: user:profile:delete
  /api/user/password:
    put:
      consumes:
      - application/json
      description: 用户修改自己的登录密码
      parameters:
      - description: 密码信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/user.ChangePasswordDTO'
      produces:
      - application/json
      responses:
        "200":
          description: 密码修改成功
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "400":
          description: 参数错误或旧密码不正确
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 修改密码
      tags:
      - 用户 - 个人资料 (User - Profile)
      x-permission:
        scope: user:profile:update
  /api/user/profile:
    get:
      consumes:
      - application/json
      description: 获取当前登录用户的个人资料和角色信息
      produces:
      - application/json
      responses:
        "200":
          description: 个人资料
          schema:
            $ref: '#/definitions/response.DataResponse-user_UserWithRolesDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 用户不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取个人资料
      tags:
      - 用户 - 个人资料 (User - Profile)
      x-permission:
        scope: user:profile:read
    put:
      consumes:
      - application/json
      description: 用户更新自己的姓名、头像和个人简介
      parameters:
      - description: 更新信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handler.UpdateProfileRequest'
      produces:
      - application/json
      responses:
        "200":
          description: 资料更新成功
          schema:
            $ref: '#/definitions/response.DataResponse-user_UserWithRolesDTO'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新个人资料
      tags:
      - 用户 - 个人资料 (User - Profile)
      x-permission:
        scope: user:profile:update
  /api/user/tokens:
    get:
      consumes:
      - application/json
      description: 获取当前用户的所有个人访问令牌（不包含令牌值）
      produces:
      - application/json
      responses:
        "200":
          description: 令牌列表
          schema:
            $ref: '#/definitions/response.DataResponse-array_pat_TokenDTO'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取个人访问令牌列表
      tags:
      - 用户 - 个人访问令牌 (User - Personal Access Token)
      x-permission:
        scope: user:tokens:read
    post:
      consumes:
      - application/json
      description: 用户创建新的个人访问令牌(PAT)，用于API访问。令牌仅在创建时显示一次
      parameters:
      - description: 令牌信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/pat.CreateTokenDTO'
      produces:
      - application/json
      responses:
        "201":
          description: 令牌创建成功
          schema:
            $ref: '#/definitions/response.DataResponse-pat_CreateTokenResultDTO'
        "400":
          description: 参数错误
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建个人访问令牌
      tags:
      - 用户 - 个人访问令牌 (User - Personal Access Token)
      x-permission:
        scope: user:tokens:create
  /api/user/tokens/{id}:
    delete:
      consumes:
      - application/json
      description: 用户删除指定的个人访问令牌（不可恢复）
      parameters:
      - description: 令牌ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 令牌删除成功
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "400":
          description: 无效的令牌ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 令牌不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除个人访问令牌
      tags:
      - 用户 - 个人访问令牌 (User - Personal Access Token)
      x-permission:
        scope: user:tokens:delete
    get:
      consumes:
      - application/json
      description: 获取指定个人访问令牌的详细信息（不包含令牌值）
      parameters:
      - description: 令牌ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 令牌详情
          schema:
            $ref: '#/definitions/response.DataResponse-pat_TokenDTO'
        "400":
          description: 无效的令牌ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: 令牌不存在
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取个人访问令牌详情
      tags:
      - 用户 - 个人访问令牌 (User - Personal Access Token)
      x-permission:
        scope: user:tokens:read
  /api/user/tokens/{id}/disable:
    patch:
      consumes:
      - application/json
      description: 暂停指定令牌的使用（可再次启用）
      parameters:
      - description: 令牌ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 令牌已禁用
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "400":
          description: 无效的令牌ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 禁用个人访问令牌
      tags:
      - 用户 - 个人访问令牌 (User - Personal Access Token)
      x-permission:
        scope: user:tokens:disable
  /api/user/tokens/{id}/enable:
    patch:
      consumes:
      - application/json
      description: 重新启用已禁用的令牌
      parameters:
      - description: 令牌ID
        in: path
        minimum: 1
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 令牌已启用
          schema:
            $ref: '#/definitions/response.MessageResponse'
        "400":
          description: 无效的令牌ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: 未授权
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 启用个人访问令牌
      tags:
      - 用户 - 个人访问令牌 (User - Personal Access Token)
      x-permission:
        scope: user:tokens:enable
securityDefinitions:
  BearerAuth:
    description: 'Bearer token authentication. Format: "Bearer {token}"'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
